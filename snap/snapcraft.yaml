name: qts3browser
version: '1.0.1' 
summary: Amazon S3 client written in QT
description: |
          Amazon S3 client written in QT.

grade: 'stable' # must be 'stable' to release into candidate/stable channels
confinement: 'strict' # use 'strict' once you have the right plugs and slots
#grade: devel # must be 'stable' to release into candidate/stable channels
#confinement: devmode # use 'strict' once you have the right plugs and slots

apps:
  s3browser:
    command: desktop-launch $SNAP/opt/s3browser/bin/s3browser
    plugs: [home, network, x11, opengl]
    desktop: s3browser.desktop
parts:
  desktop-file:
    source: desktop-file
    source-type: local
    plugin: dump
  
  aws:
    plugin: dump
    source: https://dl.bintray.com/arturfog/oss-arturfog/amazon-s3-cpp-sdk_1.6.0_amd64.deb
    source-type: deb
  
  qt59:
    plugin: dump
    source: https://dl.bintray.com/arturfog/oss-arturfog/qt-everywhere_5.10.0_amd64.deb
    source-type: deb

  application:
    source: https://github.com/arturfog/qtS3Browser.git
    stage-packages:
      - libcanberra-gtk-module
      - libx11-xcb1
      - libx11-6
      - libxau6
      - libxdamage1
      - libxdmcp6
      - libxext6
      - libxfixes3
      - libxxf86vm1
      - libdouble-conversion1v5
      - libdrm2
      - libglapi-mesa
      - libgraphite2-3
      - libharfbuzz0b
      - libicu55
      - libpcre16-3
      - libproxy1v5
      - libxcb-dri2-0
      - libxcb-dri3-0
      - libxcb-glx0
      - libxcb-present0
      - libxcb-sync1
      - libxcb1
      - libxshmfence1
    prepare: |
      export QTDIR=/opt/Qt5.10
      export QT_SELECT=qt5
    build: |
      /opt/Qt5.10/bin/qmake -o Makefile ../src/s3Browser.pro -spec linux-g++ CONFIG+=release
      make
      make install INSTALL_ROOT=../install/
    plugin: qmake
    qt-version: qt5
    after: [aws, qt59]
