name: qts3browser
version: '1.0.1' 
summary: Amazon S3 client written in QT
description: |
          Amazon S3 client written in QT.

grade: 'stable' # must be 'stable' to release into candidate/stable channels
confinement: 'strict' # use 'strict' once you have the right plugs and slots

apps:
  s3browser:
    command: bin/desktop-launch $SNAP/opt/s3browser/bin/s3browser
    plugs: 
        - home
        - network
        - x11
        - opengl
    desktop: usr/share/applications/s3browser.desktop
    environment:
        LD_LIBRARY_PATH: $LD_LIBRARY_PATH:$SNAP/opt/Qt5.10/lib
parts:
  aws:
    plugin: dump
    source: https://dl.bintray.com/arturfog/oss-arturfog/amazon-s3-cpp-sdk_1.6.0_amd64.deb
    source-type: deb
    stage-packages:
       - libssl1.0.0
       - zlib1g
       - libcurl3
       - libkrb5-3
       - libgssapi3-heimdal
       - libroken18-heimdal
       - libgnutls30
       - libp11-kit0
       - libstdc++6
       - libgcc1
       - libdb5.3
  
  qt510:
    plugin: dump
    source: https://dl.bintray.com/arturfog/oss-arturfog/qt-everywhere_5.10.0_amd64.deb
    source-type: deb
    stage-packages:
       - icu-devtools
       - libharfbuzz0b
       - libgl1-mesa-glx
       - libegl1-mesa
       - libx11-6
       - libice6
       - libicu55
       - libx11-xcb1
       - libxcb-glx0
       - libxcb-randr0

  desktopqt5:
    build-packages:
    - qtbase5-dev
    - dpkg-dev
    plugin: make
    source: https://github.com/ubuntu/snapcraft-desktop-helpers.git
    source-subdir: qt
    stage-packages:
      - light-themes
      - shared-mime-info
      - dmz-cursor-theme
      - appmenu-qt5
      - ttf-ubuntu-font-family
      - libxkbcommon0
      - libgdk-pixbuf2.0-0

  application:
    plugin: dump
    source: https://dl.bintray.com/arturfog/oss-arturfog/qts3browser_1.0.1_amd64.deb
    source-type: deb
    stage-packages:
      - libcanberra-gtk-module
      - libx11-xcb1
      - libx11-6
      - libxau6
      - libxdamage1
      - libxdmcp6
      - libxext6
      - libxfixes3
      - libxxf86vm1
      - libdouble-conversion1v5
      - libdrm2
      - libglapi-mesa
      - libgraphite2-3
      - libharfbuzz0b
      - libicu55
      - libpcre16-3
      - libproxy1v5
      - libxcb-dri2-0
      - libxcb-dri3-0
      - libxcb-glx0
      - libxcb-present0
      - libxcb-sync1
      - libxcb1
      - libxshmfence1
    after: [aws, qt510, desktopqt5]
